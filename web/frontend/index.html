<!DOCTYPE html>
<html>
<head>
<title>ATGSD Sea Pay Processor</title>
<style>
body { background:#000; color:#0f0; font-family:monospace }
label { display:block; margin-top:12px }
button,input { background:#111;color:#0f0;border:1px solid #0f0;padding:6px }
pre { background:#000; padding:10px; height:280px; overflow:auto; border:1px solid #0f0 }
.small { font-size:12px; color:#6f6 }
</style>
</head>

<body>

<h2>ATGSD Sea Pay Processor</h2>

<form method="POST" enctype="multipart/form-data">

<label>INPUT PDFs</label>
<input type="file" name="files" multiple>

<label>REPLACE TEMPLATE PDF</label>
<input type="file" name="template_file">
<div class="small">Current: {{ template_path }}</div>

<label>RATE CSV</label>
<input type="file" name="rate_file">
<div class="small">Current: {{ rate_path }}</div>

<br><br>
<button type="submit" onclick="startLogs()">RUN PROCESSOR</button>

</form>

<hr>

<button onclick="downloadAll()">‚¨á DOWNLOAD ALL GENERATED FILES</button>

<hr>

<button onclick="generateTextReport()">üìù GENERATE TEXT REPORT</button>

<script>
function generateTextReport() {
    window.location.href = "/generate_text_report";
}
</script>

<hr>

<h3>LIVE LOG CONSOLE</h3>
<pre id="logBox"></pre>

<script>
function startLogs() {
    setTimeout(pollLogs, 1000);
}

function pollLogs() {
    fetch("/logs")
        .then(r => r.text())
        .then(txt => {
            document.getElementById("logBox").innerText = txt;
            setTimeout(pollLogs, 1000);
        });
}

function downloadAll() {
    window.location.href = "/download_all";
}
</script>

</body>
</html>
