<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ATGSD SEA PAY PROCESSOR</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1e1e1e;
            color: #e5e5e5;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 90%;
            max-width: 900px;
            margin: 30px auto;
            background: #2a2a2a;
            padding: 25px;
            border-radius: 6px;
            box-shadow: 0 0 8px #000;
        }
        h1, h2, h3 {
            text-align: center;
            margin-top: 10px;
        }
        h1 {
            font-size: 32px;
            color: #4fa3ff;
        }
        .section-title {
            margin-top: 30px;
            padding-bottom: 6px;
            font-size: 20px;
            border-bottom: 2px solid #4fa3ff;
        }
        input[type="file"] {
            width: 100%;
            padding: 12px;
            margin-top: 8px;
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: #ddd;
        }
        .btn {
            background: #4fa3ff;
            color: #000;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: inline-block;
            margin-top: 15px;
        }
        .btn:hover {
            background: #6bc1ff;
        }

        .output-box {
            background: #1b1b1b;
            border: 1px solid #444;
            padding: 12px;
            margin-top: 15px;
            border-radius: 4px;
            font-size: 14px;
            white-space: pre-wrap;
        }

        .download-link {
            display: block;
            margin: 6px 0;
            color: #4fa3ff;
            text-decoration: none;
            font-weight: bold;
        }
        .download-link:hover {
            text-decoration: underline;
        }

    </style>
</head>

<body>
    <div class="container">
        <h1>ATGSD SEA PAY PROCESSOR</h1>
        <p style="text-align:center">Automated TORIS, SEA PAY PG13, and Summary File Generator</p>

        <!-- Upload Section -->
        <div class="section-title">Upload Sea Duty Certification Sheets</div>
        <form action="/process" enctype="multipart/form-data" method="post">
            <input type="file" name="files" multiple required>
            <button class="btn" type="submit">PROCESS FILES</button>
        </form>

        <!-- Output Section -->
        <div class="section-title">Generated Output</div>

        <h3>SEA PAY PG13 Files</h3>
        <div id="pg13-list" class="output-box">
            No files generated yet.
        </div>

        <h3>TORIS Sea Pay Cert Sheets</h3>
        <div id="toris-list" class="output-box">
            No files generated yet.
        </div>

        <h3>Summary Files (TXT / PDF)</h3>
        <div id="summary-list" class="output-box">
            No summaries generated yet.
        </div>

        <!-- PACKAGE -->
        <div class="section-title">Final Package</div>
        <p style="text-align:center">Generate 3 merged PDFs for printing or upload.</p>

        <form action="/package" method="post">
            <button class="btn" type="submit">GENERATE PACKAGE</button>
        </form>

        <div id="package-list" class="output-box">
            No package files yet.
        </div>

    </div>

    <script>
        // Fetch output lists and refresh dynamically
        async function refreshOutput() {
            const res = await fetch('/list_outputs');
            const data = await res.json();

            // PG13 files
            const pg13Box = document.getElementById('pg13-list');
            pg13Box.innerHTML = data.pg13.length
                ? data.pg13.map(f => `<a class="download-link" href="/download/SEA_PAY_PG13/${f}">${f}</a>`).join('')
                : "No files generated yet.";

            // TORIS Cert sheets
            const torisBox = document.getElementById('toris-list');
            torisBox.innerHTML = data.toris.length
                ? data.toris.map(f => `<a class="download-link" href="/download/TORIS_SEA_PAY_CERT_SHEET/${f}">${f}</a>`).join('')
                : "No files generated yet.";

            // Summary TXT/PDF
            const summaryBox = document.getElementById('summary-list');
            summaryBox.innerHTML = data.summary.length
                ? data.summary.map(f => `<a class="download-link" href="/download/SUMMARY/${f}">${f}</a>`).join('')
                : "No summaries generated yet.";

            // PACKAGE files
            const packageBox = document.getElementById('package-list');
            packageBox.innerHTML = data.package.length
                ? data.package.map(f => `<a class="download-link" href="/download/PACKAGE/${f}">${f}</a>`).join('')
                : "No package files yet.";
        }

        setInterval(refreshOutput, 2000);
        refreshOutput();
    </script>

</body>
</html>
